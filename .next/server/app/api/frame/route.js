"use strict";(()=>{var e={};e.id=128,e.ids=[128],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},5532:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>$,patchFetch:()=>v,requestAsyncStorage:()=>y,routeModule:()=>x,serverHooks:()=>b,staticGenerationAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{GET:()=>d,POST:()=>g});var n=r(49303),o=r(88716),s=r(60670),i=r(87070),p=r(75571),c=r(90455),u=r(92180),l=r(95908);let m="https://fc-frame-gamma.vercel.app",f="https://www.clanker.world/clanker/0xee47670a6ed7501aeeb9733efd0bf7d93ed3cb07";async function d(e){let t;let r=e.nextUrl.searchParams,a=r.get("state")||"start",n=[];if("start"!==a&&"results"!==a)try{let e=JSON.parse(Buffer.from(a,"base64").toString());e.currentQuestion,n=e.answers||[]}catch(e){n=[]}let o=[];if("start"===a||"results"===a){if("results"===a){let e=0,a=r.get("stateData");if(a)try{let t=JSON.parse(Buffer.from(a,"base64").toString());e=t.score||(0,u.mB)(t.answers||[]),n=t.answers||[]}catch(t){e=(0,u.mB)(n)}else e=(0,u.mB)(n);let s=(0,u.lU)(e);t=`${m}/api/frame/image?type=results&score=${e}&tier=${s.tier}&badge=${encodeURIComponent(s.badge)}`,o=[{label:"Buy $TABLEDADRIAN on Clanker",action:"post_redirect",target:f},{label:"Share My Score",action:"post",target:`${m}/api/frame/share?score=${e}&tier=${s.tier}&badge=${encodeURIComponent(s.badge)}`},{label:"Retake Quiz",action:"post",target:`${m}/api/frame?state=start`}]}else t=`${m}/api/frame/image?type=initial`,o=[{label:"Start Quiz",action:"post",target:`${m}/api/frame?state=q1`}]}else{let e=parseInt(a.replace("q",""))||1,r=u.Sz[e-1];if(r)t=`${m}/api/frame/image?type=question&num=${e}&total=${u.Sz.length}&text=${encodeURIComponent(r.text)}&emoji=${encodeURIComponent(r.emoji)}`,o=r.options.map((t,r)=>({label:t.text,action:"post",target:`${m}/api/frame/answer?question=${e}&answer=${r}&state=${encodeURIComponent(a)}`}));else{let e=(0,u.mB)(n),r=(0,u.lU)(e);t=`${m}/api/frame/image?type=results&score=${e}&tier=${r.tier}&badge=${encodeURIComponent(r.badge)}`,o=[{label:"Buy $TABLEDADRIAN on Clanker",action:"post_redirect",target:f},{label:"Share My Score",action:"post",target:`${m}/api/frame/share?score=${e}&tier=${r.tier}&badge=${encodeURIComponent(r.badge)}`},{label:"Retake Quiz",action:"post",target:`${m}/api/frame?state=start`}]}}let s=`
    <!DOCTYPE html>
    <html>
      <head>
        <meta property="fc:frame" content="vNext" />
        <meta property="fc:frame:image" content="${t}" />
        <meta property="og:image" content="${t}" />
        <meta property="fc:frame:button:1" content="${o[0]?.label||""}" />
        ${o[0]?.action==="link"?'<meta property="fc:frame:button:1:action" content="link" />':""}
        ${o[0]?.action==="post_redirect"?'<meta property="fc:frame:button:1:action" content="post_redirect" />':""}
        ${o[0]?.target?`<meta property="fc:frame:button:1:target" content="${o[0].target}" />`:""}
        ${o[1]?`<meta property="fc:frame:button:2" content="${o[1].label}" />`:""}
        ${o[1]?.action==="link"?'<meta property="fc:frame:button:2:action" content="link" />':""}
        ${o[1]?.action==="post_redirect"?'<meta property="fc:frame:button:2:action" content="post_redirect" />':""}
        ${o[1]?.target?`<meta property="fc:frame:button:2:target" content="${o[1].target}" />`:""}
        ${o[2]?`<meta property="fc:frame:button:3" content="${o[2].label}" />`:""}
        ${o[2]?.action==="link"?'<meta property="fc:frame:button:3:action" content="link" />':""}
        ${o[2]?.action==="post_redirect"?'<meta property="fc:frame:button:3:action" content="post_redirect" />':""}
        ${o[2]?.target?`<meta property="fc:frame:button:3:target" content="${o[2].target}" />`:""}
        <meta property="fc:frame:post_url" content="${m}/api/frame" />
        <title>Longevity Score Calculator ðŸ§¬</title>
      </head>
      <body>
        <h1>Longevity Score Calculator</h1>
        <p>Take the 2-minute science-backed longevity assessment</p>
        <p><a href="/buy" style="color: #4682B4; text-decoration: underline;">Buy $TABLEDADRIAN</a></p>
      </body>
    </html>
  `;return new i.NextResponse(s,{headers:{"Content-Type":"text/html"}})}async function g(e){try{let{untrustedData:t}=await e.json();if(!t)return i.NextResponse.redirect(new URL("/api/frame?state=start",m));let r=t.buttonIndex,a=new URL(t.url||`${m}/api/frame`);if(a.searchParams.has("answer")){let e=parseInt(a.searchParams.get("question")||"0"),t=parseInt(a.searchParams.get("answer")||"0"),r=a.searchParams.get("state")||"",n=[];if(r&&"start"!==r)try{let e=JSON.parse(Buffer.from(r,"base64").toString());e.currentQuestion,n=e.answers||[]}catch(e){}n.push({questionId:e,answerIndex:t});let o=e+1;if(o>u.Sz.length){let e=(0,u.mB)(n),t=(0,u.lU)(e);try{let r=await (0,p.getServerSession)(c.L);r?.user?.fid&&await (0,l.oE)(r.user.fid,r.user.username,e,t.tier,t.badge,n)}catch(e){console.error("Error saving user score:",e)}let r=Buffer.from(JSON.stringify({answers:n,score:e})).toString("base64"),a=new URL(`${m}/api/frame`);return a.searchParams.set("state","results"),a.searchParams.set("stateData",r),i.NextResponse.redirect(a)}{let e=Buffer.from(JSON.stringify({currentQuestion:o,answers:n})).toString("base64"),t=new URL(`${m}/api/frame`);return t.searchParams.set("state",`q${o}`),t.searchParams.set("stateData",e),i.NextResponse.redirect(t)}}if("start"===a.searchParams.get("state")||1===r){let e=new URL(`${m}/api/frame`);return e.searchParams.set("state","q1"),i.NextResponse.redirect(e)}return i.NextResponse.redirect(new URL("/api/frame?state=start",m))}catch(e){return console.error("Frame POST error:",e),i.NextResponse.redirect(new URL("/api/frame?state=start",m))}}let x=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/frame/route",pathname:"/api/frame",filename:"route",bundlePath:"app/api/frame/route"},resolvedPagePath:"C:\\Users\\anton\\Desktop\\ta_project\\ta_farcaster\\app\\api\\frame\\route.tsx",nextConfigOutput:"",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:h,serverHooks:b}=x,$="/api/frame/route";function v(){return(0,s.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:h})}},90455:(e,t,r)=>{r.d(t,{L:()=>a});let a={providers:[(0,r(53797).Z)({name:"Farcaster",credentials:{message:{label:"Message",type:"text"},signature:{label:"Signature",type:"text"},fid:{label:"FID",type:"text"},username:{label:"Username",type:"text"}},authorize:async e=>e?.fid?{id:e.fid,name:e.username||`User ${e.fid}`,fid:parseInt(e.fid),username:e.username}:null})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.fid=t.fid,e.username=t.username),e),session:async({session:e,token:t})=>(e.user&&(e.user.fid=t.fid,e.user.username=t.username),e)},pages:{signIn:"/auth/signin"},secret:process.env.NEXTAUTH_SECRET,session:{strategy:"jwt"}}},92180:(e,t,r)=>{r.d(t,{Sz:()=>a,kW:()=>s,lU:()=>o,mB:()=>n});let a=[{id:1,text:"How many servings of vegetables do you eat daily?",emoji:"\uD83E\uDD57",options:[{text:"0 servings",points:0},{text:"1-3 servings",points:6},{text:"4-6 servings",points:10},{text:"7+ servings",points:13}]},{id:2,text:"Hours of sleep per night?",emoji:"\uD83D\uDCA4",options:[{text:"< 5 hours",points:0},{text:"5-6 hours",points:4},{text:"7-8 hours",points:12},{text:"9+ hours",points:8}]},{id:3,text:"Exercise frequency?",emoji:"\uD83C\uDFC3",options:[{text:"Never",points:0},{text:"1-2x/week",points:6},{text:"3-4x/week",points:10},{text:"Daily",points:13}]},{id:4,text:"Do you follow Mediterranean diet principles?",emoji:"\uD83C\uDF47",options:[{text:"Never",points:0},{text:"Sometimes",points:6},{text:"Often",points:10},{text:"Always",points:13}]},{id:5,text:"Stress management practice?",emoji:"\uD83E\uDDD8",options:[{text:"None",points:0},{text:"Occasional",points:4},{text:"Regular",points:10},{text:"Daily",points:13}]},{id:6,text:"Social connections?",emoji:"\uD83D\uDC65",options:[{text:"Isolated",points:0},{text:"Few friends",points:4},{text:"Active social life",points:10},{text:"Strong community",points:13}]},{id:7,text:"Fasting habits?",emoji:"â°",options:[{text:"Never",points:0},{text:"Occasional",points:6},{text:"Regular IF",points:10},{text:"Extended fasts",points:12}]},{id:8,text:"Supplement routine?",emoji:"\uD83D\uDC8A",options:[{text:"None",points:2},{text:"Basic vitamins",points:6},{text:"Targeted stack",points:10},{text:"Biohacker protocol",points:12}]}];function n(e){let t=0;e.forEach(e=>{let r=a.find(t=>t.id===e.questionId);r&&r.options[e.answerIndex]&&(t+=r.options[e.answerIndex].points)});let r=a.reduce((e,t)=>e+Math.max(...t.options.map(e=>e.points)),0);return Math.round(t/r*100)}function o(e){let t,r,a,n,o;return e>=86?(t="longevity-champion",r="\uD83C\uDFC6 Longevity Champion! You're optimizing your health at the highest level.",a=["Maintain your current routine - you're doing exceptional!","Consider sharing your strategies with the community","Explore advanced biohacking protocols if interested"],n="Platinum",o="#E5E4E2"):e>=66?(t="thriving",r="âœ¨ Thriving! You're on an excellent path to longevity.",a=["Focus on consistency in your current habits","Add 1-2 more servings of vegetables daily","Prioritize 7-8 hours of quality sleep"],n="Gold",o="#FFD700"):e>=41?(t="good-foundation",r="\uD83C\uDF31 Good Foundation! You have solid habits to build upon.",a=["Aim for 5+ servings of vegetables daily","Establish a regular exercise routine (3-4x/week)","Practice stress management techniques daily"],n="Silver",o="#C0C0C0"):(t="needs-attention",r="\uD83D\uDCAA Needs Attention - but every journey starts with awareness!",a=["Start with 2-3 servings of vegetables daily","Aim for 7-8 hours of sleep consistently","Begin with 2-3 exercise sessions per week"],n="Bronze",o="#CD7F32"),{score:e,tier:t,message:r,tips:a,badge:n,badgeColor:o}}function s(e,t){return({"longevity-champion":`Scoring ${t}/100 puts you in the top tier of longevity optimization!`,thriving:`With ${t}/100, you're thriving on your longevity journey!`,"good-foundation":`Your ${t}/100 score shows a solid foundation for longevity.`,"needs-attention":`Your ${t}/100 score is a great starting point for improvement!`})[e]}},95908:(e,t,r)=>{r.d(t,{UM:()=>i,Zp:()=>s,oE:()=>n,sA:()=>o});let a=[];async function n(e,t,r,n,o,s){a.push({fid:e,username:t,score:r,tier:n,badge:o,answers:s,timestamp:new Date})}async function o(e){return a.filter(t=>t.fid===e).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime())}async function s(e=10){let t=new Map;return a.forEach(e=>{let r=t.get(e.fid);(!r||e.score>r.score)&&t.set(e.fid,e)}),Array.from(t.values()).sort((e,t)=>t.score-e.score).slice(0,e)}async function i(e){let t=(await s(1e3)).findIndex(t=>t.fid===e);return t>=0?t+1:-1}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972,790],()=>r(5532));module.exports=a})();